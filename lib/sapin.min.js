!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define("sapin",["lodash"],t):"object"==typeof exports?exports.sapin=t(require("lodash")):e.sapin=t(e._)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConfig=t.defaultConfig=t.noTrim=t.Errors=void 0;var i=r(0),n=(t.Errors={required:"sapin.required",isNumber:"sapin.invalidNumber",isInteger:"sapin.invalidInteger",isPositive:"sapin.valueShouldBePositive",isNegative:"sapin.valueShouldBeNegative",isGt:"sapin.valueShouldBeGt",isGte:"sapin.valueShouldBeGte",isLt:"sapin.valueShouldBeLt",isLte:"sapin.valueShouldBeLte",isGtField:"sapin.valueShouldBeGtField",isGteToField:"sapin.valueShouldBeGteField",isLtField:"sapin.valueShouldBeLtField",isLteToField:"sapin.valueShouldBeLteField",withinRange:"sapin.valueNotInRange",minLength:"sapin.valueNotLongEnough",maxLength:"sapin.valueTooLong",isEmail:"sapin.invalidEmail"},t.noTrim=function(){return!0}),u=function(e){return e},o=function(e,t,r,u){var o=(0,i.get)(e,t,void 0);return"string"==typeof o&&u.useTrim&&((0,i.isArray)(r)&&-1!==r.indexOf(n)||(o=(0,i.trim)(o))),o},a=function(e){var t=e;return(0,i.isString)(t)&&(t=t.replace(",",".")),Number(t)},l=function(e){return void 0===e||null===e||""===e},s=t.defaultConfig={formatError:u,getValue:o,getNumber:a,isEmptyValue:l,useTrim:!0,params:{}};t.createConfig=function(e){var t=Object.assign({},s,e);return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collection=t.ValidatorTypes=void 0;var i=r(0),n=t.ValidatorTypes={object:1,collectionOfValues:2,collectionOfObjects:3};t.collection=function(e,t){var r={__validator:e,__valueValidator:t};return(0,i.isArray)(e)?r.__type=n.collectionOfValues:r.__type=n.collectionOfObjects,r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(4);Object.defineProperty(t,"isNumber",{enumerable:!0,get:function(){return i.isNumber}}),Object.defineProperty(t,"isInteger",{enumerable:!0,get:function(){return i.isInteger}}),Object.defineProperty(t,"isPositive",{enumerable:!0,get:function(){return i.isPositive}}),Object.defineProperty(t,"isNegative",{enumerable:!0,get:function(){return i.isNegative}}),Object.defineProperty(t,"isGt",{enumerable:!0,get:function(){return i.isGt}}),Object.defineProperty(t,"isGte",{enumerable:!0,get:function(){return i.isGte}}),Object.defineProperty(t,"isLt",{enumerable:!0,get:function(){return i.isLt}}),Object.defineProperty(t,"isLte",{enumerable:!0,get:function(){return i.isLte}}),Object.defineProperty(t,"isGtField",{enumerable:!0,get:function(){return i.isGtField}}),Object.defineProperty(t,"isGteToField",{enumerable:!0,get:function(){return i.isGteToField}}),Object.defineProperty(t,"isLtField",{enumerable:!0,get:function(){return i.isLtField}}),Object.defineProperty(t,"isLteToField",{enumerable:!0,get:function(){return i.isLteToField}}),Object.defineProperty(t,"withinRange",{enumerable:!0,get:function(){return i.withinRange}});var n=r(5);Object.defineProperty(t,"required",{enumerable:!0,get:function(){return n.required}}),Object.defineProperty(t,"requiredIfOtherFieldIsTrue",{enumerable:!0,get:function(){return n.requiredIfOtherFieldIsTrue}}),Object.defineProperty(t,"requiredIfOtherFieldIsFalse",{enumerable:!0,get:function(){return n.requiredIfOtherFieldIsFalse}}),Object.defineProperty(t,"requiredIfOtherFieldEquals",{enumerable:!0,get:function(){return n.requiredIfOtherFieldEquals}});var u=r(1);Object.defineProperty(t,"createConfig",{enumerable:!0,get:function(){return u.createConfig}}),Object.defineProperty(t,"noTrim",{enumerable:!0,get:function(){return u.noTrim}});var o=r(6);Object.defineProperty(t,"minLength",{enumerable:!0,get:function(){return o.minLength}}),Object.defineProperty(t,"maxLength",{enumerable:!0,get:function(){return o.maxLength}}),Object.defineProperty(t,"isEmail",{enumerable:!0,get:function(){return o.isEmail}});var a=r(2);Object.defineProperty(t,"collection",{enumerable:!0,get:function(){return a.collection}});var l=r(7);Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return l.validate}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withinRange=t.isLtField=t.isLteToField=t.isGtField=t.isGteToField=t.isLt=t.isLte=t.isGt=t.isGte=t.isNegative=t.isPositive=t.isInteger=t.isNumber=void 0;var i=r(0),n=r(1),u=(t.isNumber=function(e){var t=e.value,r=e.config;if(r.isEmptyValue(t))return null;var i=r.getNumber(t);return isNaN(i)?n.Errors.isNumber:null},t.isInteger=function(e){var t=e.value,r=e.config;if(r.isEmptyValue(t))return null;var i=r.getNumber(t);return Number.isInteger(i)?null:n.Errors.isInteger},function(e,t,r){var i=null;if(!r.isEmptyValue(e)){var u=r.getNumber(e);isNaN(u)?i=n.Errors.isNumber:t&&u<0?i=n.Errors.isPositive:!t&&u>=0&&(i=n.Errors.isNegative)}return i}),o=(t.isPositive=function(e){var t=e.value,r=e.config;return u(t,!0,r)},t.isNegative=function(e){var t=e.value,r=e.config;return u(t,!1,r)},function(e,t,r,n){var u={value:void 0,otherFieldValue:void 0};n.isEmptyValue(e)||(u.value=n.getNumber(e));var o=(0,i.get)(r,t);return n.isEmptyValue(o)||(u.otherFieldValue=n.getNumber(o)),u}),a=function(e,t,r,i,u,a,l){var s=null,c=o(e,t,i,u);return isNaN(c.value)||isNaN(c.otherFieldValue)?void 0!==c.value&&isNaN(c.value)&&(s=n.Errors.isNumber):s=a(c.value,c.otherFieldValue)?null:{error:l,params:{value:e,otherFieldValue:c.otherFieldValue,otherFieldLabel:r}},s},l=function(e,t,r,i,u){var o=null,a=NaN;return i.isEmptyValue(e)||(a=i.getNumber(e),isNaN(a)?o=n.Errors.isNumber:t(a,r)||(o={error:u,params:{value:e,threshold:r}})),o};t.isGte=function(e){return function(t){var r=t.value,u=t.config;return l(r,i.gte,e,u,n.Errors.isGte)}},t.isGt=function(e){return function(t){var r=t.value,u=t.config;return l(r,i.gt,e,u,n.Errors.isGt)}},t.isLte=function(e){return function(t){var r=t.value,u=t.config;return l(r,i.lte,e,u,n.Errors.isLte)}},t.isLt=function(e){return function(t){var r=t.value,u=t.config;return l(r,i.lt,e,u,n.Errors.isLt)}},t.isGteToField=function(e,t){return function(r){var u=r.value,o=r.siblings,l=r.config;return a(u,e,t,o,l,i.gte,n.Errors.isGteToField)}},t.isGtField=function(e,t){return function(r){var u=r.value,o=r.siblings,l=r.config;return a(u,e,t,o,l,i.gt,n.Errors.isGtField)}},t.isLteToField=function(e,t){return function(r){var u=r.value,o=r.siblings,l=r.config;return a(u,e,t,o,l,i.lte,n.Errors.isLteToField)}},t.isLtField=function(e,t){return function(r){var u=r.value,o=r.siblings,l=r.config;return a(u,e,t,o,l,i.lt,n.Errors.isLtField)}},t.withinRange=function(e,t){return function(r){var i=r.value,u=r.config;if(u.isEmptyValue(i))return null;var o=u.getNumber(i);return isNaN(o)?n.Errors.isNumber:o<e||o>t?{error:n.Errors.withinRange,params:{value:i,minValue:e,maxValue:t}}:null}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.requiredIfOtherFieldEquals=t.requiredIfOtherFieldIsFalse=t.requiredIfOtherFieldIsTrue=t.required=void 0;var i=r(0),n=r(1),u=t.required=function(e){var t=e.value;return e.config.isEmptyValue(t)?n.Errors.required:null};t.requiredIfOtherFieldIsTrue=function(e){return function(t){return(0,i.get)(t.siblings,e,!1)?u(t):null}},t.requiredIfOtherFieldIsFalse=function(e){return function(t){return(0,i.get)(t.siblings,e,!0)?null:u(t)}},t.requiredIfOtherFieldEquals=function(e,t){t=(0,i.isArray)(t)?t:[t];var r=new Set(t);return function(t){var n=(0,i.get)(t.siblings,e,!1);return r.has(n)?u(t):null}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxLength=t.minLength=t.isEmail=void 0;var i=r(1),n=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/;t.isEmail=function(e){var t=e.value;return e.config.isEmptyValue(t)?null:n.test(t)?null:i.Errors.isEmail},t.minLength=function(e){return function(t){var r=t.value,n=t.config,u=null;return!n.isEmptyValue(r)&&r.length<e&&(u={error:i.Errors.minLength,params:{value:r,minLength:e}}),u}},t.maxLength=function(e){return function(t){var r=t.value,n=t.config,u=null;return!n.isEmptyValue(r)&&r.length>e&&(u={error:i.Errors.maxLength,params:{value:r,maxLength:e}}),u}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validate=void 0;var i=(r(0),r(1)),n=r(8);t.validate=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r=r||i.defaultConfig;return new n.ValidatorRunner(e,t,r).run()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValidatorRunner=void 0;var i=r(0),n=r(2),u=t.ValidatorRunner=function(e,t,r){this.entity=e,this.validators=t,(0,i.assign)(this,r)};u.prototype.run=function(){return this.errors={},this.validateObject(null,this.entity,this.validators,this.entity),this.errors},u.prototype.runFunctions=function(e,t,r){for(var i=null,n=0;!i&&n<t.length;n++){i=(0,t[n])({value:e,siblings:r,entity:this.entity,config:this})}return i};u.prototype.setError=function(e,t,r){var n=(0,i.isObject)(t)?t:{error:t,params:{value:r}},u=this.formatError(n);(0,i.setWith)(this.errors,e,u,Object)},u.prototype.validateField=function(e,t,r,n){r=(0,i.isFunction)(r)?[r]:r;var u=this.runFunctions(t,r,n);u&&this.setError(e,u,t)},u.prototype.applyValueValidatorOnObject=function(e,t,r,i){var n=this.runFunctions(t,r,i);n&&this.setError(e+"._error",n,t)},u.prototype.validateCollectionOfObjects=function(e,t,r){var n=this;(0,i.forEach)(t,function(i,u){var o=e+"."+u;n.validateObject(o,i,r,i,t)})},u.prototype.validateCollectionOfValues=function(e,t,r,n){var u=this;(0,i.forEach)(t,function(i,o){var a=e+"."+o,l=u.getValue(t,o,r,u);u.validateField(a,l,r,n)})},u.prototype.validateObject=function(e,t,r,u){for(var o in r){var a=r[o],l=e?e+"."+o:o,s=this.getValue(t,o,a,this);(0,i.isArray)(a)||(0,i.isFunction)(a)?this.validateField(l,s,a,u):a.__type||this.validateObject(l,s,a,s),a.__valueValidator&&this.applyValueValidatorOnObject(l,s,a.__valueValidator,u),a.__type===n.ValidatorTypes.collectionOfObjects?this.validateCollectionOfObjects(l,s,a.__validator):a.__type===n.ValidatorTypes.collectionOfValues&&this.validateCollectionOfValues(l,s,a.__validator,t)}}}])});