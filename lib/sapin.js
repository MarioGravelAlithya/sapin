!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define("sapin",["lodash"],t):"object"==typeof exports?exports.sapin=t(require("lodash")):e.sapin=t(e._)}(self,(function(e){return(()=>{"use strict";var t={607:t=>{t.exports=e}},i={};function l(e){var r=i[e];if(void 0!==r)return r.exports;var n=i[e]={exports:{}};return t[e](n,n.exports,l),n.exports}l.d=(e,t)=>{for(var i in t)l.o(t,i)&&!l.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{l.r(r),l.d(r,{collection:()=>Q,createConfig:()=>c,isEmail:()=>M,isGt:()=>S,isGtField:()=>I,isGte:()=>j,isGteToField:()=>B,isInteger:()=>N,isLt:()=>x,isLtField:()=>q,isLte:()=>L,isLteToField:()=>T,isNegative:()=>O,isNumber:()=>b,isPositive:()=>F,maxLength:()=>z,minLength:()=>R,noTrim:()=>d,required:()=>P,requiredIfOtherFieldEquals:()=>Z,requiredIfOtherFieldIsFalse:()=>w,requiredIfOtherFieldIsTrue:()=>C,validate:()=>ce,withinRange:()=>A});var e=l(607);const{get:t,trim:i,isArray:n,isString:a,keys:o,filter:s}=e,u="sapin.invalidNumber",d=()=>!0,p={formatError:e=>e,getValue:(e,l,r,a)=>{let o=t(e,l,void 0);return"string"==typeof o&&a.useTrim&&(n(r)&&-1!==r.indexOf(d)||(o=i(o))),o},getNumber:e=>{let t=e;return a(t)&&(t=t.replace(",",".")),Number(t)},isEmptyValue:e=>null==e||""===e,useTrim:!0,params:{}},c=e=>Object.assign({},p,e),{isNil:v,get:g,gt:f,gte:h,lt:m,lte:y}=e,b=({value:e,config:t})=>{if(t.isEmptyValue(e))return null;const i=t.getNumber(e);return isNaN(i)?u:null},N=({value:e,config:t})=>{if(t.isEmptyValue(e))return null;const i=t.getNumber(e);return Number.isInteger(i)?null:"sapin.invalidInteger"},V=(e,t,i)=>{let l=null;if(!i.isEmptyValue(e)){const r=i.getNumber(e);isNaN(r)?l=u:t&&r<0?l="sapin.valueShouldBePositive":!t&&r>=0&&(l="sapin.valueShouldBeNegative")}return l},F=({value:e,config:t})=>V(e,!0,t),O=({value:e,config:t})=>V(e,!1,t),_=(e,t,i,l,r,n,a)=>{let o=null;const s=((e,t,i,l)=>{const r={value:void 0,otherFieldValue:void 0};l.isEmptyValue(e)||(r.value=l.getNumber(e));let n=g(i,t);return l.isEmptyValue(n)||(r.otherFieldValue=l.getNumber(n)),r})(e,t,l,r);return isNaN(s.value)||isNaN(s.otherFieldValue)?void 0!==s.value&&isNaN(s.value)&&(o=u):o=n(s.value,s.otherFieldValue)?null:{error:a,params:{value:e,otherFieldValue:s.otherFieldValue,otherFieldLabel:i}},o},E=(e,t,i,l,r)=>{let n=null,a=NaN;return l.isEmptyValue(e)||(a=l.getNumber(e),isNaN(a)?n=u:t(a,i)||(n={error:r,params:{value:e,threshold:i}})),n},j=e=>({value:t,config:i})=>E(t,h,e,i,"sapin.valueShouldBeGte"),S=e=>({value:t,config:i})=>E(t,f,e,i,"sapin.valueShouldBeGt"),L=e=>({value:t,config:i})=>E(t,y,e,i,"sapin.valueShouldBeLte"),x=e=>({value:t,config:i})=>E(t,m,e,i,"sapin.valueShouldBeLt"),B=(e,t)=>({value:i,siblings:l,config:r})=>_(i,e,t,l,r,h,"sapin.valueShouldBeGteField"),I=(e,t)=>({value:i,siblings:l,config:r})=>_(i,e,t,l,r,f,"sapin.valueShouldBeGtField"),T=(e,t)=>({value:i,siblings:l,config:r})=>_(i,e,t,l,r,y,"sapin.valueShouldBeLteField"),q=(e,t)=>({value:i,siblings:l,config:r})=>_(i,e,t,l,r,m,"sapin.valueShouldBeLtField"),A=(e,t)=>({value:i,config:l})=>{if(l.isEmptyValue(i))return null;const r=l.getNumber(i);return isNaN(r)?u:r<e||r>t?{error:"sapin.valueNotInRange",params:{value:i,minValue:e,maxValue:t}}:null},{get:G,isArray:$}=e,P=({value:e,config:t})=>t.isEmptyValue(e)?"sapin.required":null,C=e=>t=>G(t.siblings,e,!1)?P(t):null,w=e=>t=>G(t.siblings,e,!0)?null:P(t),Z=(e,t)=>{t=$(t)?t:[t];const i=new Set(t);return t=>{const l=G(t.siblings,e,!1);return i.has(l)?P(t):null}},k=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,M=({value:e,config:t})=>t.isEmptyValue(e)||k.test(e)?null:"sapin.invalidEmail",R=e=>({value:t,config:i})=>{let l=null;return!i.isEmptyValue(t)&&t.length<e&&(l={error:"sapin.valueNotLongEnough",params:{value:t,minLength:e}}),l},z=e=>({value:t,config:i})=>{let l=null;return!i.isEmptyValue(t)&&t.length>e&&(l={error:"sapin.valueTooLong",params:{value:t,maxLength:e}}),l},{isNil:W,isArray:D,isObject:H,isFunction:J,every:K}=e,Q=(e,t)=>{const i={__validator:e,__valueValidator:t};return D(e)||J(e)?i.__type=2:i.__type=3,i},{setWith:U,forEach:X,isArray:Y,assign:ee,isObject:te,omit:ie,size:le,isNil:re,isFunction:ne}=e,ae=function(e,t,i){this.entity=e,this.validators=t,ee(this,i)};ae.prototype.run=function(){return this.errors={},this.validateObject(null,this.entity,this.validators,this.entity),this.errors},ae.prototype.runFunctions=function(e,t,i){let l=null;Y(t)||(t=[t]);for(let r=0;!l&&r<t.length;r++)l=(0,t[r])({value:e,siblings:i,entity:this.entity,config:this});return l},ae.prototype.setError=function(e,t,i){const l=te(t)?t:{error:t,params:{value:i}},r=this.formatError(l);U(this.errors,e,r,Object)},ae.prototype.validateField=function(e,t,i,l){i=ne(i)?[i]:i;const r=this.runFunctions(t,i,l);r&&this.setError(e,r,t)},ae.prototype.applyValueValidatorOnObject=function(e,t,i,l){const r=this.runFunctions(t,i,l);r&&this.setError(`${e}._error`,r,t)},ae.prototype.validateCollectionOfObjects=function(e,t,i){X(t,((l,r)=>{const n=`${e}.${r}`;this.validateObject(n,l,i,l,t)}))},ae.prototype.validateCollectionOfValues=function(e,t,i,l){X(t,((r,n)=>{const a=`${e}.${n}`,o=this.getValue(t,n,i,this);this.validateField(a,o,i,l)}))},ae.prototype.validateObject=function(e,t,i,l){for(let r in i){const n=i[r],a=e?`${e}.${r}`:r,o=this.getValue(t,r,n,this);Y(n)||ne(n)?this.validateField(a,o,n,l):n.__type||this.validateObject(a,o,n,o),n.__valueValidator&&this.applyValueValidatorOnObject(a,o,n.__valueValidator,l),3===n.__type?this.validateCollectionOfObjects(a,o,n.__validator):2===n.__type&&this.validateCollectionOfValues(a,o,n.__validator,t)}};const{isObject:oe,isArray:se,isFunction:ue,keys:de,omit:pe}=e,ce=(e,t,i=null)=>new ae(e,t,i=i||p).run()})(),r})()}));
//# sourceMappingURL=sapin.js.map